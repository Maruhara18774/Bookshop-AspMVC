USE BOOKSHOP


CREATE TABLE THELOAI(
ID_THELOAI INT IDENTITY(1,1) PRIMARY KEY,
TEN_THELOAI NVARCHAR(255)
)

CREATE TABLE NHAXUATBAN(
ID_NXB INT IDENTITY(1,1) PRIMARY KEY,
TEN_NHAXUATBAN NVARCHAR(255) 
)

CREATE TABLE NHACUNGCAP(
ID_NCC INT IDENTITY(1,1) PRIMARY KEY,
TEN_NHACUNGCAP NVARCHAR(255)
)

CREATE TABLE TACGIA(
ID_TACGIA INT IDENTITY(1,1) PRIMARY KEY,
TEN_TACGIA NVARCHAR(255)
)

CREATE TABLE SACH (
ID_SACH INT IDENTITY(1,1) PRIMARY KEY,
TEN_SACH NVARCHAR(255),
LOAI_BIA NVARCHAR(100),
NGAY_XUATBAN VARCHAR(20),
SOLUONG_TON SMALLINT,
SO_TRANG SMALLINT,
KICH_THUOC VARCHAR(20),
MOTA TEXT,
ID_NXB INT,
ID_TACGIA INT,
ID_NCC INT,
ID_THELOAI INT,
KHOILUONG FLOAT,
GIA_BIA FLOAT,
GIA_BAN FLOAT,
CONSTRAINT FK_SACH_NXB FOREIGN KEY(ID_NXB) REFERENCES NHAXUATBAN (ID_NXB),
CONSTRAINT FK_SACH_TACGIA FOREIGN KEY(ID_TACGIA) REFERENCES TACGIA (ID_TACGIA),
CONSTRAINT FK_SACH_NCC FOREIGN KEY(ID_NCC) REFERENCES NHACUNGCAP (ID_NCC),
CONSTRAINT FK_SACH_THELOAI FOREIGN KEY(ID_THELOAI) REFERENCES THELOAI (ID_THELOAI),
)

CREATE TABLE BANGGIA(
ID_BANGGIA INT IDENTITY(1,1) PRIMARY KEY,
ID_SACH INT,
NGAY_APDUNG VARCHAR(20),
TANG_GIAM BIT,
GIATRI FLOAT,
CONSTRAINT FK_BANGGIA_SACH FOREIGN KEY(ID_SACH) REFERENCES SACH (ID_SACH),
)


CREATE TABLE ANHBIA(
ID_ANH INT IDENTITY(1,1) PRIMARY KEY,
ID_SACH INT,
ANH VARCHAR(MAX),
CONSTRAINT FK_ANHBIA_SACH FOREIGN KEY(ID_SACH) REFERENCES SACH (ID_SACH)
)

CREATE TABLE FEEDBACK(
ID_FEEDBACK INT IDENTITY(1,1) PRIMARY KEY,
ID_SACH INT,
XACNHAN_MUAHANG BIT,
DIEM_DANHGIA TINYINT,
THOIGIAN_DANG VARCHAR(20),
NOIDUNG TEXT,
CONSTRAINT FK_FEEDBACK_SACH FOREIGN KEY(ID_SACH) REFERENCES SACH (ID_SACH)
)

CREATE TABLE ANHFEEDBACK(
ID_ANH INT IDENTITY(1,1) PRIMARY KEY,
ID_FEEDBACK INT,
ANH VARCHAR(MAX),
CONSTRAINT FK_ANHFEED_FEEDBACK FOREIGN KEY(ID_FEEDBACK) REFERENCES FEEDBACK (ID_FEEDBACK)
)

CREATE TABLE DIEUKIENKHUYENMAI(
ID_DIEUKIEN INT IDENTITY(1,1) PRIMARY KEY,
THOIGIAN_BATDAU VARCHAR(20),
THOIGIAN_KETTHUC VARCHAR(20),
MUC_TIEUDUNG FLOAT
)

CREATE TABLE LOAITAIKHOAN(
ID_LOAITK INT IDENTITY(1,1) PRIMARY KEY,
TEN_LOAITK NVARCHAR(255),
MUC_DATDUOC FLOAT DEFAULT 0
)

CREATE TABLE KHUYENMAI(
ID_KHUYENMAI INT IDENTITY(1,1) PRIMARY KEY,
ID_LOAITK INT,
ID_DIEUKIEN INT,
TEN_KHUYENMAI NVARCHAR(255),
THOIGIAN_BATDAU VARCHAR(20),
THOIGIAN_KETTHUC VARCHAR(20),
CONSTRAINT FK_KHUYENMAI_DIEUKIEN FOREIGN KEY(ID_DIEUKIEN) REFERENCES DIEUKIENKHUYENMAI(ID_DIEUKIEN),
CONSTRAINT FK_KHUYENMAI_LOAITK FOREIGN KEY(ID_LOAITK) REFERENCES LOAITAIKHOAN(ID_LOAITK)
)

CREATE TABLE HINHANHKHUYENMAI(
ID_HINHANH INT IDENTITY(1,1) PRIMARY KEY,
ID_KHUYENMAI INT,
HINHANH VARCHAR(MAX),
CONSTRAINT FK_HINHANH_KHUYENMAI FOREIGN KEY(ID_KHUYENMAI) REFERENCES KHUYENMAI(ID_KHUYENMAI)
)

CREATE TABLE SANPHAMKHUYENMAI(
ID_SPKM INT IDENTITY(1,1) PRIMARY KEY,
ID_SACH INT,
GIA_BAN FLOAT,
SOLUONG SMALLINT,
ID_KHUYENMAI INT,
CONSTRAINT FK_SANPHAMKM_KHUYENMAI FOREIGN KEY(ID_KHUYENMAI) REFERENCES KHUYENMAI(ID_KHUYENMAI)
)

CREATE TABLE TAIKHOANNGANHANG(
ID_TKNH INT IDENTITY(1,1) PRIMARY KEY,
TEN_NGANHANG NVARCHAR(200),
MA_PIN INT
)

CREATE TABLE TAIKHOANQUANTRIVIEN(
ID_QUANTRIVIEN INT IDENTITY(1,1) PRIMARY KEY,
TEN_DANGNHAP NVARCHAR(100) UNIQUE,
MATKHAU NVARCHAR(100),
TEN_QUANTRIVIEN NVARCHAR(255),
ANH_DAIDIEN VARCHAR(MAX)
)

CREATE TABLE THONGTINKHACHHANG(
ID_TTKH INT IDENTITY(1,1) PRIMARY KEY,
TEN_KHACHHANG NVARCHAR(255),
EMAIL_KHACHHANG NVARCHAR(255),
DIACHI TEXT,
SO_DIENTHOAI VARCHAR(20),
TONG_TIEUDUNG FLOAT
)

CREATE TABLE TAIKHOANKHACHHANG(
ID_KHACHHANG INT IDENTITY(1,1) PRIMARY KEY,
TEN_DANGNHAP NVARCHAR(100) UNIQUE,
MATKHAU NVARCHAR(100),
ANH_DAIDIEN VARCHAR(MAX),
ID_LOAITK INT,
ID_TTKH INT,
CONSTRAINT FK_TKKH_LOAITK FOREIGN KEY(ID_LOAITK) REFERENCES LOAITAIKHOAN(ID_LOAITK),
CONSTRAINT FK_TKKH_TTKH FOREIGN KEY(ID_TTKH) REFERENCES THONGTINKHACHHANG(ID_TTKH)
)

CREATE TABLE TRANGTHAIDONHANG(
ID_TRANGTHAI INT IDENTITY(1,1) PRIMARY KEY,
TEN_TRANGTHAI NVARCHAR(200)
)

CREATE TABLE DONHANG(
ID_DONHANG INT IDENTITY(1,1) PRIMARY KEY,
ID_TTKH INT,
ID_TRANGTHAI INT,
TONGTIEN FLOAT,
THOIGIAN_DAT VARCHAR(20),
CONSTRAINT FK_DONHANG_TRANGTHAI FOREIGN KEY(ID_TRANGTHAI) REFERENCES TRANGTHAIDONHANG(ID_TRANGTHAI),
CONSTRAINT FK_DONHANG_TTKH FOREIGN KEY(ID_TTKH) REFERENCES THONGTINKHACHHANG(ID_TTKH)
)


CREATE TABLE CHITIETDONHANG(
ID_CTDH INT IDENTITY(1,1) PRIMARY KEY,
ID_DONHANG INT,
ID_SACH INT,
ID_SPKM INT,
GIA_BAN FLOAT,
SOLUONG SMALLINT,
TONGTIEN FLOAT,
CONSTRAINT FK_CTDH_DONHANG FOREIGN KEY(ID_DONHANG) REFERENCES DONHANG(ID_DONHANG),
CONSTRAINT FK_CTDH_SACH FOREIGN KEY(ID_SACH) REFERENCES SACH(ID_SACH),
CONSTRAINT FK_CTDH_SANPHAMKHUYENMAI FOREIGN KEY(ID_SPKM) REFERENCES SANPHAMKHUYENMAI(ID_SPKM)
)

CREATE TABLE HOADON(
ID_HOADON INT IDENTITY(1,1) PRIMARY KEY,
ID_TTKH INT,
ID_TRANGTHAI INT,
TONGTIEN FLOAT,
ID_DONHANG INT,
CONSTRAINT FK_HOADON_TTKH FOREIGN KEY(ID_TTKH) REFERENCES THONGTINKHACHHANG(ID_TTKH),
CONSTRAINT FK_HOADON_TRANGTHAI FOREIGN KEY(ID_TRANGTHAI) REFERENCES TRANGTHAIDONHANG(ID_TRANGTHAI),
CONSTRAINT FK_HOADON_DONHANG FOREIGN KEY(ID_DONHANG) REFERENCES DONHANG(ID_DONHANG),
)


CREATE TABLE CHITIETHOADON(
ID_CTHD INT IDENTITY(1,1) PRIMARY KEY,
ID_HOADON INT,
ID_SACH INT,
ID_SPKM INT,
GIA_BAN FLOAT,
SOLUONG SMALLINT,
TONGTIEN FLOAT,
CONSTRAINT FK_CTHD_HOADON FOREIGN KEY(ID_HOADON) REFERENCES HOADON(ID_HOADON),
CONSTRAINT FK_CTHD_SACH FOREIGN KEY(ID_SACH) REFERENCES SACH(ID_SACH),
CONSTRAINT FK_CTHD_SANPHAMKHUYENMAI FOREIGN KEY(ID_SPKM) REFERENCES SANPHAMKHUYENMAI(ID_SPKM)
)